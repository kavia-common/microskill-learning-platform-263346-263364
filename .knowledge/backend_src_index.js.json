{"is_source_file": true, "format": "JavaScript", "description": "Main server application file for a backend API built with Express.js. It sets up middleware, routes for skills, progress, enrollment, health check, and static assets, and handles in-memory data related to skills and user progress.", "external_files": ["express", "helmet", "morgan", "express-rate-limit", "cors", "dotenv", "express-validator", "nanoid"], "external_methods": ["loadEnv", "validateRequest", "getUserId", "getProgressStore", "calculateStats", "errorPayload", "seedSkills"], "published": ["app"], "classes": [], "methods": [{"name": "getUserId(req)", "description": "Retrieves user ID from request headers or defaults to 'anon'. Used for associating progress and enrollments.", "scope": "", "scopeKind": ""}, {"name": "getProgressStore(userId, skillId)", "description": "Retrieves or initializes the progress data store for a specific user and skill.", "scope": "", "scopeKind": ""}, {"name": "calculateStats(skill, items)", "description": "Calculates progress statistics such as watched lessons, completed lessons, overall completion percentage, points, etc.", "scope": "", "scopeKind": ""}, {"name": "validateRequest(req, res, next)", "description": "Middleware function that validates incoming requests using express-validator and returns validation errors if any.", "scope": "", "scopeKind": ""}, {"name": "sanitizeValidationError(e)", "description": "Sanitizes validation error objects to limit potential exposure of sensitive data.", "scope": "", "scopeKind": ""}, {"name": "scrub(v)", "description": "Helper function to trim long strings in validation errors to prevent logging large PII.", "scope": "", "scopeKind": ""}, {"name": "errorPayload(code, message, details)", "description": "Constructs a standardized error response payload with timestamp.", "scope": "", "scopeKind": ""}, {"name": "seedSkills()", "description": "Creates and returns initial sample skills data with lessons for demonstration or testing purposes.", "scope": "", "scopeKind": ""}, {"name": "AnonymousFunction62af637a0100(origin, callback)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["loadEnv()", "validateRequest", "getUserId(req)", "getProgressStore(userId, skillId)", "calculateStats(skill, store.items)", "errorPayload(...)", "seedSkills()"], "search-terms": ["index.js", "express rate limit", "skills API", "progress tracking", "in-memory data", "skills seed data", "health check endpoint", "CORS configuration", "security headers"], "state": 2, "file_id": 62, "knowledge_revision": 214, "git_revision": "", "ctags": [{"_type": "tag", "name": "AnonymousFunction62af637a0100", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^  origin: function (origin, callback) {$/", "language": "JavaScript", "kind": "function", "signature": "(origin, callback)"}, {"_type": "tag", "name": "FRONTEND_ORIGIN", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^const FRONTEND_ORIGIN = process.env.FRONTEND_ORIGIN$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "LOG_LEVEL", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^const LOG_LEVEL = (process.env.LOG_LEVEL || process.env.REACT_APP_LOG_LEVEL || 'info').toLowerCa/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "NODE_ENV", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^const NODE_ENV = process.env.NODE_ENV || 'development';$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "PORT", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^const PORT = parseInt(process.env.PORT || '3001', 10);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "TRUST_PROXY", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^const TRUST_PROXY = String(process.env.TRUST_PROXY || process.env.REACT_APP_TRUST_PROXY || 'fals/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^const app = express();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "calculateStats", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^function calculateStats(skill, items) {$/", "language": "JavaScript", "kind": "function", "signature": "(skill, items)"}, {"_type": "tag", "name": "enrollments", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^const enrollments = new Map(); \\/\\/ userId -> Set(skillId)$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "errorPayload", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^function errorPayload(code, message, details) {$/", "language": "JavaScript", "kind": "function", "signature": "(code, message, details)"}, {"_type": "tag", "name": "getProgressStore", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^function getProgressStore(userId, skillId) {$/", "language": "JavaScript", "kind": "function", "signature": "(userId, skillId)"}, {"_type": "tag", "name": "getUserId", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^function getUserId(req) {$/", "language": "JavaScript", "kind": "function", "signature": "(req)"}, {"_type": "tag", "name": "items", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^    store = { items: [], updatedAt: new Date().toISOString() };$/", "language": "JavaScript", "kind": "property", "scope": "getProgressStore.store", "scopeKind": "class"}, {"_type": "tag", "name": "limiter", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^const limiter = rateLimit({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "location", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^    location: e.location,$/", "language": "JavaScript", "kind": "property", "scope": "sanitizeValidationError.out", "scopeKind": "class"}, {"_type": "tag", "name": "msg", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^    msg: e.msg,$/", "language": "JavaScript", "kind": "property", "scope": "sanitizeValidationError.out", "scopeKind": "class"}, {"_type": "tag", "name": "out", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^  const out = {$/", "language": "JavaScript", "kind": "class", "scope": "sanitizeValidationError", "scopeKind": "class"}, {"_type": "tag", "name": "path", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^    path: e.path,$/", "language": "JavaScript", "kind": "property", "scope": "sanitizeValidationError.out", "scopeKind": "class"}, {"_type": "tag", "name": "progress", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^const progress = new Map(); \\/\\/ userId -> Map(skillId -> { items: [], updatedAt })$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "sanitizeValidationError", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^function sanitizeValidationError(e) {$/", "language": "JavaScript", "kind": "function", "signature": "(e)"}, {"_type": "tag", "name": "scrub", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^function scrub(v) {$/", "language": "JavaScript", "kind": "function", "signature": "(v)"}, {"_type": "tag", "name": "seedSkills", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^function seedSkills() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "skills", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^const skills = seedSkills();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "store", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^    store = { items: [], updatedAt: new Date().toISOString() };$/", "language": "JavaScript", "kind": "class", "scope": "getProgressStore", "scopeKind": "class"}, {"_type": "tag", "name": "type", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^    type: e.type,$/", "language": "JavaScript", "kind": "property", "scope": "sanitizeValidationError.out", "scopeKind": "class"}, {"_type": "tag", "name": "updatedAt", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^    store = { items: [], updatedAt: new Date().toISOString() };$/", "language": "JavaScript", "kind": "property", "scope": "getProgressStore.store", "scopeKind": "class"}, {"_type": "tag", "name": "validateRequest", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^function validateRequest(req, res, next) {$/", "language": "JavaScript", "kind": "function", "signature": "(req, res, next)"}, {"_type": "tag", "name": "value", "path": "/home/kavia/workspace/code-generation/microskill-learning-platform-263346-263364/backend/src/index.js", "pattern": "/^    value: scrub(e.value),$/", "language": "JavaScript", "kind": "property", "scope": "sanitizeValidationError.out", "scopeKind": "class"}], "hash": "9c92e4a9879ae8ef85f64a877e9143ce", "format-version": 4, "code-base-name": "frontend_react", "filename": "backend/src/index.js", "fields": [{"name": "store = { items: [], updatedAt: new Date().toISOString() };", "scope": "getProgressStore.store", "scopeKind": "class", "description": "unavailable"}, {"name": "location: e.location,", "scope": "sanitizeValidationError.out", "scopeKind": "class", "description": "unavailable"}, {"name": "msg: e.msg,", "scope": "sanitizeValidationError.out", "scopeKind": "class", "description": "unavailable"}, {"name": "path: e.path,", "scope": "sanitizeValidationError.out", "scopeKind": "class", "description": "unavailable"}, {"name": "type: e.type,", "scope": "sanitizeValidationError.out", "scopeKind": "class", "description": "unavailable"}, {"name": "value: scrub(e.value),", "scope": "sanitizeValidationError.out", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"214": ""}]}